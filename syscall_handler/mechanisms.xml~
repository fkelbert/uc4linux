<?xml version="1.0"?>

<monitorConfiguration
	xmlns="http://www.master-fp7.eu/Master-EnfLang-FHG"
	xmlns:event="http://www.master-fp7.eu/event"
	xmlns:propositionalLogic="http://www.master-fp7.eu/propositionalLogic"
	xmlns:pastOSL="http://www.master-fp7.eu/pastOSL"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.master-fp7.eu event.xsd
						http://www.master-fp7.eu propositionalLogic.xsd
						http://www.master-fp7.eu pastOSL.xsd
						http://www.master-fp7.eu Master-EnfLang-FHG.xsd">


<controlMechanism>
  <id>DiaryProtection</id>
  <description>
    This part ensures that the file can only be opened using the mentioned tools.
  </description>
  <triggerEvent xmlns="http://www.master-fp7.eu/event">
    <id>open</id>
    <parameter name="filename" value="/home/alice/AlicesDiary.txt" type="dataUsage"/>
  </triggerEvent>
  <condition xmlns="http://www.master-fp7.eu/pastOSL">
    <and>
      <and>
        <XPathEval>/triggerEvent/parameter[@name='command']/@value!='vsftpd'</XPathEval>
        <XPathEval>/triggerEvent/parameter[@name='command']/@value!='mousepad'</XPathEval>
      </and>
      <XPathEval>notOPENPARcontainsOPENPAR/triggerEvent/parameter[@name='command']/@valueCOMMA'gftp'CLOSEPARCLOSEPAR</XPathEval>
    </and>
 </condition>
  <actions>
    <inhibit/>
  </actions>  
</controlMechanism>



<controlMechanism>
  <id>DiaryProtection2</id>
  <description>
    This part ensures that the file can not be saved to /share/. 
  </description>
  <triggerEvent xmlns="http://www.master-fp7.eu/event">
    <id>write</id>
    <parameter name="filename" value="/home/alice/AlicesDiary.txt" type="dataUsage"/>
  </triggerEvent>
  <condition xmlns="http://www.master-fp7.eu/pastOSL">
      <XPathEval>starts-withOPENPAR/triggerEvent/parameter[@name='filename']/@valueCOMMA'/share/'CLOSEPAR</XPathEval>
 </condition>
  <actions>
    <inhibit/>
  </actions>  
</controlMechanism>


</monitorConfiguration>
 
 
