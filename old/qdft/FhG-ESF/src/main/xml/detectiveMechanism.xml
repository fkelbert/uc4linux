<?xml version="1.0" encoding="UTF-8"?>
<reactiveMechanism name="Detective1"
  xmlns="http://www.iese.fhg.de/esf/1.0/enforcementLanguage"
  xmlns:t="http://www.iese.fhg.de/esf/1.0/time"
  xmlns:a="http://www.iese.fhg.de/esf/1.0/action" 
  xmlns:e="http://www.iese.fhg.de/esf/1.0/event"
  xmlns:mc="http://www.master-fp7.eu/mcalculus.xsd"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="
    http://www.iese.fhg.de/esf/1.0/time time-FhG.xsd
    http://www.iese.fhg.de/esf/1.0/action action-FhG.xsd
    http://www.iese.fhg.de/esf/1.0/event event-FhG.xsd
    http://www.iese.fhg.de/esf/1.0/enforcementLanguage enforcementLanguage-FhG.xsd
    http://www.master-fp7.eu/mcalculus.xsd mcalculus.xsd">

  <actionDescriptions>
    <a:actionDescription name="login">
      <a:parameterDescription name="result"/>
    </a:actionDescription>
    <a:actionDescription name="logout"/>
  </actionDescriptions>

  <description>Test of detective mechanism</description>
  <timestep amount="1" unit="SECONDS"/>
  <condition>
    <not>
      <implies>
        <and>
          <and>
            <before amount="3"><true/></before>
            <false/>
          </and>
          <repSince limit="2">
              <eventMatch action="login">
                <e:paramMatch name="result" value="failed"/>
              </eventMatch>
              <eventMatch action="logout"/>
          </repSince>
        </and>
        <false/>
      </implies>
    </not> 
    </condition> 

</reactiveMechanism>
