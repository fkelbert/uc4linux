<?xml version="1.0" encoding="UTF-8"?>
<policySet xmlns="http://www.iese.fhg.de/esf/1.0/enforcementLanguage"
	xmlns:tns="http://www.iese.fhg.de/esf/1.0/enforcementLanguage" xmlns:a="http://www.iese.fhg.de/esf/1.0/action"
	xmlns:e="http://www.iese.fhg.de/esf/1.0/event" xmlns:mc="http://www.master-fp7.eu/mcalculus.xsd"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="
    http://www.iese.fhg.de/esf/1.0/enforcementLanguage enforcementLanguage-FhG.xsd
    http://www.iese.fhg.de/esf/1.0/action action-FhG.xsd
    http://www.iese.fhg.de/esf/1.0/event event-FhG.xsd
    http://www.master-fp7.eu/mcalculus.xsd mcalculus.xsd">

	<actionDescriptions>
		<a:actionDescription name="uc.event.INTENT">
			<a:parameterDescription name="intentAction" />
			<a:parameterDescription name="uid" />
			<a:parameterDescription name="uri" />
			<a:parameterDescription name="type" />
			<a:parameterDescription name="component" />
			<a:parameterDescription name="category" />
			<a:parameterDescription name="extra" />
		</a:actionDescription>
	</actionDescriptions>

	<preventiveMechanism name="Test1">
		<description>Test1</description>
		<timestep amount="1" unit="SECONDS" />
		<trigger action="uc.event.INTENT" index="ALL" isTry="true">
		</trigger>
		<condition>
      <repMax limit="2">
        <and>
          <xPathEval>//event/parameter[starts-with(@name, 'taint')]/@value = '0x10000'</xPathEval>
		  <xPathEval>//event/parameter[@name='component']/@value = 'android/com.android.internal.app.ResolverActivity'</xPathEval>
        </and>
      </repMax>
    </condition>
		<authorizationAction>
			<inhibit/>
		</authorizationAction>
		<action name="notify">
			<a:parameter name="ticker" value="UC Alert!" />
			<a:parameter name="title" value="Restricted access" />
			<a:parameter name="msg"	value="The access to this file (and all its copys) is restricted." />
		</action>
	</preventiveMechanism>
</policySet>
