<?xml version="1.0" encoding="UTF-8"?>
<policySet xmlns="http://www.iese.fhg.de/pef/1.0/enforcementLanguage"
  xmlns:tns="http://www.iese.fhg.de/pef/1.0/enforcementLanguage"
  xmlns:a="http://www.iese.fhg.de/pef/1.0/action" xmlns:e="http://www.iese.fhg.de/pef/1.0/event"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

  <interfaceDescriptions>
    <pep name="jpdpPEP" type="jni">
      <parameter name="className"
        value="de/fraunhofer/iese/pef/pdp/PolicyDecisionPoint" />
      <parameter name="methodName" value="handlePEPsubscribe" />
      <parameter name="methodSignature" value="(Ljava/lang/String;I)I" />
    </pep>
    <pxp name="jpdpPXP" type="jni">
      <parameter name="className"
        value="de/fraunhofer/iese/pef/pdp/PolicyDecisionPoint" />
      <parameter name="methodName" value="handlePXPexecute" />
      <parameter name="methodSignature"
        value="(Ljava/lang/String;Ljava/util/ArrayList;)I" />
    </pxp>
  </interfaceDescriptions>

  <actionDescriptions>
    <actionDescription name="uc.event.normalizedmessage">
      <parameterDescription name="id" />
      <parameterDescription name="mep" />
      <parameterDescription name="status" />
      <parameterDescription name="role" />
      <parameterDescription name="target" />
      <parameterDescription name="operation" />
      <parameterDescription name="in" />
      <parameterDescription name="out" />
      <parameterDescription name="fault" />
    </actionDescription>
  </actionDescriptions>

  <preventiveMechanism name="AnonymizeCardForIRL5">
    <description>...</description>
    <timestep amount="1" unit="SECONDS" />
    <trigger action="uc.event.normalizedmessage" isTry="true">
      <paramMatch name="status" value="Active" />
      <paramMatch name="role" value="Consumer" />
      <paramMatch name="operation"
        value="{http://emergent.iese.fraunhofer.de/irl}requestOrder" />
      <paramMatch name="target"
        value="PropertyMatchingReference[{SERVICE_NAME={http://emergent.iese.fraunhofer.de/irl/}IRLService}]" />
    </trigger>
    <condition>
      <xPathEval>contains(//event/parameter[@name='in']/@value,'&lt;orderId&gt;5&lt;/orderId&gt;')
      </xPathEval>
    </condition>
    <authorizationAction name="auth1">
      <allow>
        <modify>
          <parameter name="in"
            value="xpath$//tns:requestOrder/order/photo$anonymizeImage" />
        </modify>
      </allow>
    </authorizationAction>
  </preventiveMechanism>
  <preventiveMechanism name="DeanonymizeCardForSF1o5">
    <description>...</description>
    <timestep amount="1" unit="SECONDS" />
    <trigger action="uc.event.normalizedmessage" isTry="true">
      <paramMatch name="status" value="Active" />
      <paramMatch name="role" value="Consumer" />
      <paramMatch name="operation"
        value="{http://emergent.iese.fraunhofer.de/sf}requestProduction" />
      <paramMatch name="target"
        value="PropertyMatchingReference[{SERVICE_NAME={http://emergent.iese.fraunhofer.de/sf/}SFService}]" />
    </trigger>
    <condition>
      <xPathEval>contains(//event/parameter[@name='in']/@value,'&lt;orderId&gt;5&lt;/orderId&gt;')
      </xPathEval>
    </condition>
    <authorizationAction name="auth2">
      <allow>
        <modify>
          <parameter name="in"
            value="xpath$//tns:requestProduction/order/photo$deanonymizeImage" />
        </modify>
      </allow>
    </authorizationAction>
  </preventiveMechanism>
  <preventiveMechanism name="DeanonymizeCardForSF2o5">
    <description>...</description>
    <timestep amount="1" unit="SECONDS" />
    <trigger action="uc.event.normalizedmessage" isTry="true">
      <paramMatch name="status" value="Active" />
      <paramMatch name="role" value="Consumer" />
      <paramMatch name="operation"
        value="{http://emergent.iese.fraunhofer.de/sf2}requestProduction" />
      <paramMatch name="target"
        value="PropertyMatchingReference[{SERVICE_NAME={http://emergent.iese.fraunhofer.de/sf2/}SF2Service}]" />
    </trigger>
    <condition>
      <xPathEval>contains(//event/parameter[@name='in']/@value,'&lt;orderId&gt;5&lt;/orderId&gt;')
      </xPathEval>
    </condition>
    <authorizationAction name="auth3">
      <allow>
        <modify>
          <parameter name="in"
            value="xpath$//tns:requestProduction/order/photo$deanonymizeImage" />
        </modify>
      </allow>
    </authorizationAction>
  </preventiveMechanism>
  <preventiveMechanism name="DeanonymizeCardForSF3o5">
    <description>...</description>
    <timestep amount="1" unit="SECONDS" />
    <trigger action="uc.event.normalizedmessage" isTry="true">
      <paramMatch name="status" value="Active" />
      <paramMatch name="role" value="Consumer" />
      <paramMatch name="operation"
        value="{http://emergent.iese.fraunhofer.de/sf3}requestProduction" />
      <paramMatch name="target"
        value="PropertyMatchingReference[{SERVICE_NAME={http://emergent.iese.fraunhofer.de/sf3/}SF3Service}]" />
    </trigger>
    <condition>
      <xPathEval>contains(//event/parameter[@name='in']/@value,'&lt;orderId&gt;5&lt;/orderId&gt;')
      </xPathEval>
    </condition>
    <authorizationAction name="auth4">
      <allow>
        <modify>
          <parameter name="in"
            value="xpath$//tns:requestProduction/order/photo$deanonymizeImage" />
        </modify>
      </allow>
    </authorizationAction>
  </preventiveMechanism>
</policySet>
