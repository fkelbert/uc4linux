<?xml version="1.0"?>
<policySet
  xmlns="http://www.iese.fhg.de/pef/1.0/enforcementLanguage"
	xmlns:tns="http://www.iese.fhg.de/pef/1.0/enforcementLanguage" 
	xmlns:a="http://www.iese.fhg.de/pef/1.0/action"
	xmlns:e="http://www.iese.fhg.de/pef/1.0/event" 
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" >

  <preventiveMechanism name="BlockTestCONT">
    <description>Do not allow content of file 'contacts.cont.db' to be open by app. nano</description>
    <timestep amount="2" unit="SECONDS"/>
    <trigger action="open" isTry="true">
      <paramMatch name="user" value="user"/>
      <paramMatch name="filename" value="/home/user/contacts.cont"/>
    </trigger>
    <condition>
      <xPathEval>/event/parameter[@name='command']/@value='cat'</xPathEval>
    </condition>
    <authorizationAction name="default"> <inhibit/> </authorizationAction>  
  </preventiveMechanism>
						
  <preventiveMechanism  name="BlockTestDATA">
    <description>Do not allow content of file 'contacts.data.db' to be open by app. nano</description>
    <timestep amount="2" unit="SECONDS"/>
    <trigger action="open" isTry="true">
      <paramMatch name="user" value="user"/>
      <paramMatch name="filename" value="/home/user/contacts.data" type="dataUsage"/>
    </trigger>
    <condition>
      <xPathEval>/event/parameter[@name='command']/@value='cat'</xPathEval>
    </condition>
    <authorizationAction name="default"> <inhibit/> </authorizationAction>  
  </preventiveMechanism>
  
  <preventiveMechanism  name="BlockTestContDelay">
    <description>Do not allow content of file 'contacts.data.db' to be open by app. nano</description>
    <timestep amount="2" unit="SECONDS"/>
    <trigger action="open" isTry="true">
      <paramMatch name="user" value="user"/>
      <paramMatch name="filename" value="/home/user/contacts.cont"/>
    </trigger>
    <condition>
      <xPathEval>/event/parameter[@name='command']/@value='cat'</xPathEval>
    </condition>
    <authorizationAction name="default"> 
      <allow> 
        <delay amount="5" unit="SECONDS"/>
          <modify>
            <parameter name="filename" value="/home/user/contactsSAV.cont"/>
          </modify>      
      </allow>
    </authorizationAction>  
  </preventiveMechanism>  

<preventiveMechanism  name="CloseTest">
    <description>Do not allow content of file 'contacts.data.db' to be open by app. nano</description>
    <timestep amount="2" unit="SECONDS"/>
    <trigger action="close" isTry="true">
      <paramMatch name="user" value="rd"/>
      <paramMatch name="filename" value="/home/user/contacts.cont"/>
    </trigger>
    <condition>
      <xPathEval>/event/parameter[@name='command']/@value='cat'</xPathEval>
    </condition>
    <authorizationAction name="default"> 
      <allow> 
        <delay amount="5" unit="SECONDS"/>
          <modify>
            <parameter name="filename" value="/home/user/contactsSAV.cont"/>
          </modify>      
      </allow>
    </authorizationAction>  
  </preventiveMechanism>    
  
</policySet>
 
 
