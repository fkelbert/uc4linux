<?xml version="1.0" encoding="UTF-8"?>
<policySet xmlns="http://www.iese.fhg.de/pef/1.0/enforcementLanguage"
		   xmlns:tns="http://www.iese.fhg.de/pef/1.0/enforcementLanguage" 
		   xmlns:a="http://www.iese.fhg.de/pef/1.0/action"
		   xmlns:e="http://www.iese.fhg.de/pef/1.0/event" 
		   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

	<interfaceDescriptions>
		<pep name="noxPEP" type="native" />
		<pxp name="noxPXP" type="native" />
	</interfaceDescriptions>

	<actionDescriptions>
	</actionDescriptions>

	<!--examples - parameter
		name="in_port" 	value="256" type="int"
		name="dl_vlan" 	value="900" type="int"
		name="dl_src"  	value="f6:b2:45:3a:22:cc" type="string"
		name="dl_dst"  	value="f6:b2:45:3a:22:cc" type="string"
		name="nw_src"  	value="10.128.14.160" type="string"
		name="nw_dst"  	value="192.168.1.101" type="string"
		name="tp_src"  	value="80" type="int"
		name="tp_dst"  	value="80" type="int"
		name="tp_flags" value="2" type="int"


	<preventiveMechanism name="Modify">
		<description>Modify specified parameters</description>
		<timestep amount="30" unit="SECONDS" />
		<trigger action="openflow.event.RECEIVE" isTry="true">
			<paramMatch name="nw_dst" value="192.168.2.103" />
			<paramMatch name="tp_dst" value="80" type="int" />
		</trigger>
		<condition>
			<true />
		</condition>
		<authorizationAction name="DropPacketOnHeaderAction">
			<allow>
				<modify>
					<parameter name="in_port" value="256" />
					<parameter name="dl_vlan" value="900" />
					<parameter name="dl_src" value="f6:b2:45:3a:22:cc" />
					<parameter name="dl_dst" value="f6:b2:45:3a:22:cc" />
					<parameter name="nw_src" value="192.168.1.101" />
					<parameter name="nw_dst" value="192.168.1.101" />
					<parameter name="tp_src" value="256" />
					<parameter name="tp_dst" value="99" />
				</modify>
			</allow>
		</authorizationAction>
	</preventiveMechanism>
		-->
	
	<preventiveMechanism name="Modify">
		<description>Modify specified parameters</description>
		<timestep amount="30" unit="SECONDS" />
		<trigger action="openflow.event.RECEIVE" isTry="true">
			<paramMatch name="nw_dst" value="192.168.2.105" />
		</trigger>
		<condition>
			<true />
		</condition>
		<authorizationAction name="DropMod">
			<allow>
				<modify>
					<parameter name="nw_src" value="192.168.2.103" />
				</modify>
			</allow>
		</authorizationAction>
	</preventiveMechanism>
	<!--
	<preventiveMechanism name="DropPacketOnHeader">
		<description>Drop packets if header fields match</description>
		<timestep amount="30" unit="SECONDS" />
		<trigger action="openflow.event.RECEIVE" isTry="true">
			<paramMatch name="nw_dst" value="192.168.2.103" />
		</trigger>
		<condition>
			<true />
		</condition>
		<authorizationAction name="DropPacketOnHeaderAction">
			<allow />
		</authorizationAction>
	</preventiveMechanism>
	
	

<preventiveMechanism name="DropPacketOnHeader">
		<description>Drop packets if header fields match</description>
		<timestep amount="30" unit="SECONDS" />
		<trigger action="openflow.event.RECEIVE" isTry="true">
			<paramMatch name="nw_dst" value="192.168.1.101" />
			<paramMatch name="tp_dst" value="8193" type="int" />
		</trigger>
		<condition>
			<true />
		</condition>
		<authorizationAction name="DropPacketOnHeaderAction">
			<inhibit />
		</authorizationAction>
	</preventiveMechanism>
	

	<preventiveMechanism name="regex">
		<description>Drop packets if regex match</description>
		<timestep amount="30" unit="SECONDS" />
		<trigger action="openflow.event.RECEIVE" isTry="true">
			<paramMatch name="nw_src" value="xxx.xxx.x.*" type="regex" />
		</trigger>
		<condition>
			<true />
		</condition>
		<authorizationAction name="regexAction">
			<inhibit />
		</authorizationAction>
	</preventiveMechanism>


	<preventiveMechanism name="RestrictUsageOnCardinality">
		<description>Connection only allowed ten times</description>
		<timestep amount="1" unit="SECONDS" />
		<trigger action="openflow.event.RECEIVE" isTry="true">
			<paramMatch name="nw_dst" value="192.168.2.xxx" />
			<paramMatch name="tp_dst" value="80" type="int" />
		</trigger>
		<condition>
			<not>
				<repMax limit="10">
					<eventMatch action="openflow.event.RECEIVE" isTry="true">
						<paramMatch name="nw_dst" value="192.168.2.xxx" />
						<paramMatch name="tp_dst" value="80" type="int" />
					</eventMatch>
				</repMax>
			</not>
		</condition>
		<authorizationAction name="RestrictUsageOnCardinalityAction">
			<inhibit />
		</authorizationAction>
	</preventiveMechanism>


	<preventiveMechanism name="RestrictUsageOnTime">
		<description>Connection to a web server is only allowed for specified
			time after initial access</description>
		<timestep amount="1" unit="SECONDS" />
		<trigger action="openflow.event.RECEIVE" isTry="true">
			<paramMatch name="nw_dst" value="192.168.2.xxx" />
			<paramMatch name="tp_dst" value="80" type="int" />
		</trigger>
		<condition>
			<not>
				<before amount="20" unit="TIMESTEPS">
					<eventMatch action="openflow.event.RECEIVE" isTry="true">
						<paramMatch name="nw_dst" value="192.168.2.xxx" />
						<paramMatch name="tp_dst" value="80" type="int" />
					</eventMatch>
				</before>
			</not>
		</condition>
		<authorizationAction name="RestrictUsageOnTimeAction">
			<inhibit />
		</authorizationAction>
		<action name="closePort">
			<parameter name="msg"
				value="Updating the HSR list is only allowed every 30 seconds..." />
		</action>
	</preventiveMechanism>-->


</policySet>